<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="style.css">
        <script src="externalJs.js"></script>
        <script>document.title = video.title;</script>
    </head>
    <body>
        <!-- 상단바 -->
        <script>showHeader(myAccount);</script>
        <div class="container">
            <div class="row">
                <!-- 좌측 사이드바 modal -->
                <div class="modal" id="modal-left" style="background-color: rgb(0,0,0,0.4);">
                    <div class="col side-bar-home modal-left">
                        <div style="position: absolute; top: 0px; left: 0px;">
                            <button class="left-btn" id="close-left">
                                <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;"><path d="M21 6H3V5h18v1zm0 5H3v1h18v-1zm0 6H3v1h18v-1z"></path></svg>
                            </button>
                            <a href="index.html">
                                <img src="img/yt_icon.png" alt="" class="home-icon">
                            </a>
                        </div>
                        <script>showLeftside(false, false);</script>
                    </div>
                </div>
                <div class="col vid-cont" style="position: relative;">
                    <div class="row" style="position: relative;">
                        <!-- 영상 및 설명 -->
                        <script>showVideo(video);</script>
                        <!-- 구독 -->
                        <button class="subscribe">구독</button>
                        <!-- 좋아요/싫어요 버튼 -->
                        <button id="like" class="like-btn">
                            <div class="row">
                                <div class="col" style="max-width: 20px; margin-left: 20px; margin-bottom: 5px;">
                                    <?xml version="1.0" standalone="no"?>
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="20" height="20">
                                        <path id="likeIcon" fill="#000000" d="M273 495.9v428l.3-428zm538.2-88.3H496.8l9.6-198.4c.6-11.9-4.7-23.1-14.6-30.5-6.1-4.5-13.6-6.8-21.1-6.7-19.6.1-36.9 13.4-42.2 32.3-37.1 134.4-64.9 235.2-83.5 302.5V852h399.4a56.85 56.85 0 0 0 33.6-51.8c0-9.7-2.3-18.9-6.9-27.3l-13.9-25.4 21.9-19a56.76 56.76 0 0 0 19.6-43c0-9.7-2.3-18.9-6.9-27.3l-13.9-25.4 21.9-19a56.76 56.76 0 0 0 19.6-43c0-9.7-2.3-18.9-6.9-27.3l-14-25.5 21.9-19a56.76 56.76 0 0 0 19.6-43c0-19.1-11-37.5-28.8-48.4z"/>
                                        <path d="M112 528v364c0 17.7 14.3 32 32 32h65V496h-65c-17.7 0-32 14.3-32 32zm773.9 5.7c16.8-22.2 26.1-49.4 26.1-77.7 0-44.9-25.1-87.5-65.5-111a67.67 67.67 0 0 0-34.3-9.3H572.3l6-122.9c1.5-29.7-9-57.9-29.5-79.4a106.4 106.4 0 0 0-77.9-33.4c-52 0-98 35-111.8 85.1l-85.8 310.8-.3 428h472.1c9.3 0 18.2-1.8 26.5-5.4 47.6-20.3 78.3-66.8 78.3-118.4 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7 0-12.6-1.8-25-5.4-37 16.8-22.2 26.1-49.4 26.1-77.7 0-12.6-1.8-25-5.4-37zM820.4 499l-21.9 19 14 25.5a56.2 56.2 0 0 1 6.9 27.3c0 16.5-7.1 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 0 1 6.9 27.3c0 16.5-7.1 32.2-19.6 43l-21.9 19 13.9 25.4a56.2 56.2 0 0 1 6.9 27.3c0 22.4-13.2 42.6-33.6 51.8H345V506.8c18.6-67.2 46.4-168 83.5-302.5a44.28 44.28 0 0 1 42.2-32.3c7.5-.1 15 2.2 21.1 6.7 9.9 7.4 15.2 18.6 14.6 30.5l-9.6 198.4h314.4C829 418.5 840 436.9 840 456c0 16.5-7.1 32.2-19.6 43z"/>
                                    </svg>
                                </div>
                                <div class="col" style="max-width: 80px; margin-top: 3px; margin-right: 5px;">
                                    <p id="likeNum" style="margin: 0px; padding: 0px;">1234</p>
                                </div>
                            </div>
                        </button>
                        <button id="dislike" class="dislike-btn">
                            <?xml version="1.0" standalone="no"?>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="20" height="20">
                                <path id="dislikeIcon" fill="#D9D9D9" d="M273 100.1v428h.3l-.3-428zM820.4 525l-21.9-19 14-25.5a56.2 56.2 0 0 0 6.9-27.3c0-16.5-7.1-32.2-19.6-43l-21.9-19 13.9-25.4a56.2 56.2 0 0 0 6.9-27.3c0-16.5-7.1-32.2-19.6-43l-21.9-19 13.9-25.4a56.2 56.2 0 0 0 6.9-27.3c0-22.4-13.2-42.6-33.6-51.8H345v345.2c18.6 67.2 46.4 168 83.5 302.5a44.28 44.28 0 0 0 42.2 32.3c7.5.1 15-2.2 21.1-6.7 9.9-7.4 15.2-18.6 14.6-30.5l-9.6-198.4h314.4C829 605.5 840 587.1 840 568c0-16.5-7.1-32.2-19.6-43z"/>
                                <path d="M112 132v364c0 17.7 14.3 32 32 32h65V100h-65c-17.7 0-32 14.3-32 32zm773.9 358.3c3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-28.3-9.3-55.5-26.1-77.7 3.6-12 5.4-24.4 5.4-37 0-51.6-30.7-98.1-78.3-118.4a66.1 66.1 0 0 0-26.5-5.4H273l.3 428 85.8 310.8C372.9 889 418.9 924 470.9 924c29.7 0 57.4-11.8 77.9-33.4 20.5-21.5 31-49.7 29.5-79.4l-6-122.9h239.9c12.1 0 23.9-3.2 34.3-9.3 40.4-23.5 65.5-66.1 65.5-111 0-28.3-9.3-55.5-26.1-77.7zm-74.7 126.1H496.8l9.6 198.4c.6 11.9-4.7 23.1-14.6 30.5-6.1 4.5-13.6 6.8-21.1 6.7a44.28 44.28 0 0 1-42.2-32.3c-37.1-134.4-64.9-235.2-83.5-302.5V172h399.4a56.85 56.85 0 0 1 33.6 51.8c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0 1 19.6 43c0 9.7-2.3 18.9-6.9 27.3l-13.9 25.4 21.9 19a56.76 56.76 0 0 1 19.6 43c0 9.7-2.3 18.9-6.9 27.3l-14 25.5 21.9 19a56.76 56.76 0 0 1 19.6 43c0 19.1-11 37.5-28.8 48.4z"/>
                            </svg>
                        </button>
                    </div>
                    <!-- 댓글창 -->
                    <div class="row">
                        <h5 id="commNum" style="margin-top: 20px; margin-bottom: 20px; padding-left: 12px; font-weight: bold;">
                            댓글 1개
                        </h5>
                        <!-- 댓글 입력 -->
                        <div class="row" style="max-height: auto; padding: 0px;">
                            <div class="col" style="max-width: 40px; margin-left: 15px;">
                                <img class="ch-profile" style="padding: 0px; margin: 0px;" src="img/profiles/my_profile.jpg" alt="" >
                            </div>
                            <div class="col" style="padding-left: 25px;">
                                <textarea type="text" id="commInput" class="comment-input" rows="1" placeholder="댓글 추가..."></textarea>
                            </div>
                        </div>
                        <div id="commBtnCont" style="position: relative; display: none;">
                            <button class="input-comm-quit">취소</button>
                            <button class="input-comm-subm" disabled="true">댓글</button>
                        </div>
                        <!-- 댓글 목록 -->
                        <div id="commList" style="margin-top: 30px;">
                            <div id="comm_1">
                                <div class="row" style="padding: 0px; margin-top: 30px;">
                                    <div class="col" style="max-width: 40px; margin-left: 15px; padding: 0px;">
                                        <img class="ch-profile" style="padding: 0px; margin: 0px;" src="img/profiles/notmy_profile.jpg" alt="" >
                                    </div>
                                    <div class="col" style="padding-left: 25px;">
                                        <div style="font-weight: bold; margin-bottom: 3px;">@someone</div>
                                        <pre>잘 보고 갑니다~</pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 우측 영상 목록 -->
                <div class="side-bar-vid">
                    <script>showRecomm(videoList, id);</script>
                </div>
            </div>
        </div>

        <script>
            // 검색어 지우기, 이동
            const searchKeyword = document.getElementById("search");
            const keywordClear = document.getElementById("clear");
            const searchBtn = document.getElementById("search-res");
            
            keywordClear.addEventListener('click', function() {
                searchKeyword.value = "";
            })

            searchKeyword.addEventListener('input', function() {
                searchBtn.disabled = false;
                if(this.value == "") searchBtn.disabled = true;
            })

            searchBtn.addEventListener('click', function() {
                location.href=`search.html?keyword=${searchKeyword.value}`;
            })

            searchKeyword.addEventListener('keydown', function(event) {
                if(event.key === "Enter" && searchKeyword.value != "") {
                    location.href=`search.html?keyword=${searchKeyword.value}`;
                }
            })

            // 계정 정보 메뉴 modal
            const modalMy = document.getElementById("modal-mymenu")
            const btnOpenModal = document.querySelector('.btn-open-modal');

            btnOpenModal.addEventListener("click", function() {
                modalMy.style.display = "flex";

            });
            modalMy.addEventListener('click', function(e) {
                if(e.target == modalMy) {
                    modalMy.style.display = "none";
                }
            })

            // 좌측 사이드바 열기/닫기 modal
            const modalLeft = document.getElementById("modal-left")
            const btnOpenLeft = document.querySelector('.left-btn');

            btnOpenLeft.addEventListener("click", function() {
                modalLeft.style.display = "flex";
            })
            modalLeft.addEventListener("click", function(e) {
                if(e.target == modalLeft) {
                    modalLeft.style.display = "none";
                }
            })
            document.getElementById("close-left").addEventListener("click", function() {
                modalLeft.style.display = "none";
            })

            // 좋아요/싫어요 버튼
            let likes = 1234;
            let isLiked = false;
            let isDisliked = false;

            const likeTxt = document.getElementById("likeNum");
            const likeBtn = document.getElementById("likeIcon");
            const dislikeBtn = document.getElementById("dislikeIcon");

            document.getElementById("like").addEventListener('click', function() {
                if(!isLiked) {
                    likes++;
                    isLiked = true;
                    likeTxt.style.fontWeight = "bold";
                    likeBtn.style.fill = "black";
                    if(isDisliked) {
                        isDisliked = false;
                        dislikeBtn.style.fill = "none";
                    }
                }
                else {
                    likes--;
                    isLiked = false;
                    likeTxt.style.fontWeight = "normal";
                    likeBtn.style.fill = "none";
                }
                likeTxt.textContent = `${likes}`;
            })

            document.getElementById("dislike").addEventListener('click', function() {
                if(!isDisliked) {
                    isDisliked = true;
                    dislikeBtn.style.fill = "black";
                    if(isLiked) {
                        likes--;
                        isLiked = false;
                        likeTxt.textContent = `${likes}`;
                        likeTxt.style.fontWeight = "normal";
                        likeBtn.style.fill = "none";
                    }
                }
                else {
                    isDisliked = false;
                    dislikeBtn.style.fill = "none";
                }
            })

            // 댓글 입력, 추가, 삭제
            let commNum = 1;
            let commId = 1;

            const commInput = document.getElementById("commInput");
            const commBtnCont = document.getElementById("commBtnCont");
            const quitBtn = document.querySelector('.input-comm-quit');
            const subBtn = document.querySelector('.input-comm-subm');
            const commList = document.getElementById("commList");

            commInput.addEventListener('focus', function() {
                commInput.style.borderBottom = "2px solid black";
                commBtnCont.style.display = "flex";
            })
            commInput.addEventListener('blur', function() {
                commInput.style.borderBottom = "1px solid lightgray";
            })
            quitBtn.addEventListener('click', function() {
                commInput.value = "";
                subBtn.disabled = true;
                commBtnCont.style.display = "none";
            })
            commInput.addEventListener('input', function() {
                subBtn.disabled = false;
                if(this.value == "") subBtn.disabled = true;
            })
            
            subBtn.addEventListener('click', function() {
                commList.insertAdjacentHTML("afterbegin",`
                    <div id="comm_${++commId}">
                        <div class="row" style="padding: 0px; margin-top: 30px;">
                            <div class="col" style="max-width: 40px; margin-left: 15px; padding: 0px;">
                                <img class="ch-profile" style="padding: 0px; margin: 0px;" src="img/profiles/my_profile.jpg" alt="" >
                            </div>
                            <div class="col" style="padding-left: 25px;">
                                <div style="font-weight: bold; margin-bottom: 3px;">${myAccount.handle}</div>
                                <pre id="text">
                                    <!-- 댓글 내용 --!>
                                </pre>
                            </div>
                            <!-- 댓글 삭제 팝업 --!>
                            <div class="delete-popup" id="delBox_${commId}" style="display: none;">
                                <button class="row" style="background-color: rgb(0,0,0,0);" value="comm_${commId}" onclick="deleteComm(this)">
                                    <div class="col" style="padding: 0px 0px 12px 0px; max-width: 24px;">
                                        <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;"><path d="M11 17H9V8h2v9zm4-9h-2v9h2V8zm4-4v1h-1v16H6V5H5V4h4V3h6v1h4zm-2 1H7v15h10V5z"></path></svg>
                                    </div>
                                    <div class="col">삭제</div>
                                </button>
                            </div>
                            <!-- 팝업 열기/닫기 버튼 --!>
                            <button class="comm-side-btn" style="margin-right: 30px;" value="${commId}" onclick="delPopup(this)">
                                <svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M12 12.5C12.2761 12.5 12.5 12.2761 12.5 12C12.5 11.7239 12.2761 11.5 12 11.5C11.7239 11.5 11.5 11.7239 11.5 12C11.5 12.2761 11.7239 12.5 12 12.5Z" fill="#000000" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12 18.5C12.2761 18.5 12.5 18.2761 12.5 18C12.5 17.7239 12.2761 17.5 12 17.5C11.7239 17.5 11.5 17.7239 11.5 18C11.5 18.2761 11.7239 18.5 12 18.5Z" fill="#000000" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12 6.5C12.2761 6.5 12.5 6.27614 12.5 6C12.5 5.72386 12.2761 5.5 12 5.5C11.7239 5.5 11.5 5.72386 11.5 6C11.5 6.27614 11.7239 6.5 12 6.5Z" fill="#000000" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
                            </button>
                        </div>
                    </div>
                `);
                document.getElementById("text").textContent = commInput.value;
                commInput.value = "";
                subBtn.disabled = true;
                commBtnCont.style.display = "none";
                document.getElementById("commNum").textContent = `댓글 ${++commNum}개`;
            })

            let delId;
            let isDelOpened = false;

            function delPopup(bt) {
                if(!isDelOpened) {
                    delId = bt.value;
                    document.getElementById(`delBox_${delId}`).style.display = "flex";
                    isDelOpened = true;
                }
                else {
                    document.getElementById(`delBox_${delId}`).style.display = "none";
                    isDelOpened = false;
                }
            }

            function deleteComm(bt) {
                document.getElementById(bt.value).remove();
                isDelOpened = false;
                document.getElementById("commNum").textContent = `댓글 ${--commNum}개`;
            }
        </script>
    </body>
</html>